<tool id="ngklast" name="Recherche d'homologie de sequences" version="0.1.0">
	<description>for each sequence in a file</description>

	<requirements>
		<requirement type="binary">@BINARY@</requirement>
		<requirement type="package" version="2.3.0">plast</requirement>
		<requirement type="package" version="2.2.31">blast+</requirement>
        </requirements>
        <version_command>@BINARY@ -h</version_command>
	
	<macros>
                <token name="@BINARY@">macro1</token>
                <import>ngklast_macros.xml</import>
        </macros>
	<parallelism method="multi" split_inputs="query" split_mode="to_size" split_size="1000" merge_outputs="output1" />


	<command>
	perl /home/nfoulqui/WorkSpace/galaxy/tools/ngklast/run_ngklast.pl
	#if $choice_algo.tool=="plast"
	/home/nfoulqui/WorkSpace/galaxy/tools/plast/plast-library/build/bin/PlastCmd
	-p "$choice_algo.choice_algo2.algo_plast"
	-i "$query"
	
	#if $choice_algo.choice_algo2.db_opts.db_opts_selector=="histdb":
	-d "$choice_algo.choice_algo2.db_opts.histdb"
	#end if
	#if $choice_algo.choice_algo2.db_opts.db_opts_selector=="db":
        -d "$choice_algo.choice_algo2.db_opts.db"
        #end if
	#if $choice_algo.choice_algo2.db_opts.db_opts_selector=="file":
        -d "$choice_algo.choice_algo2.db_opts.subject"
        #end if

	##-o "$output"
	-o "mainOutput.dat"

	-full-stats "statistic.dat"
	
	-outfmt 1

	#if $choice_algo.choice_algo2.ext_param.ext_param_selector=="extended":
	$choice_algo.choice_algo2.ext_param.filter_query
	#if $choice_algo.choice_algo2.algo_plast=="plastn":
	$choice_algo.choice_algo2.ext_param.strand
	$choice_algo.choice_algo2.ext_param.match_mismatch
	#else:
	-M $choice_algo.choice_algo2.ext_param.matrix
	$choice_algo.choice_algo2.ext_param.gap_costs	
	#end if
	#end if

	#if $choice_algo.choice_algo2.config_param.config_param_selector=="advanced":
	-a $choice_algo.choice_algo2.config_param.nb_threads
	-max-database-size $choice_algo.choice_algo2.config_param.max_db_size
	
	## [NON DISPONIBLE]
	##if (str($choice_algo.choice_algo2.config_param.ungap_threshold_nucl) and int(str($choice_algo.choice_algo2.config_param.ungap_threshold_nucl)) > 0):
	##-s $choice_algo.choice_algo2.config_param.ungap_threshold_nucl
	##end if

	#if $choice_algo.choice_algo2.algo_plast=="plastn":	
	-xdrop-ungap $choice_algo.choice_algo2.config_param.ungap_Xdrop
	## -X $choice_algo.choice_algo2.config_param.gap_Xdrop
	-Z $choice_algo.choice_algo2.config_param.final_gap_Xdrop 
	#end if
	#end if 
	#end if
	
	#if $choice_algo.tool=="blast"
	$choice_algo.choice_algo2.algo_blast
	-query "$query"

	#if $choice_algo.choice_algo2.db_opts.db_opts_selector == "db":
  		-db "${choice_algo.choice_algo2.db_opts.database.fields.path}"
	#elif $choice_algo.choice_algo2.db_opts.db_opts_selector == "histdb":
  		-db "${os.path.join($choice_algo.choice_algo2.db_opts.histdb.extra_files_path,'blastdb')}"
	#else:
  		-subject "$choice_algo.choice_algo2.db_opts.subject"
	#end if

	#if $choice_algo.choice_algo2.algo_blast=="blastx":
		-query_gencode $choice_algo.choice_algo2.query_gencode
		##-task "$choice_algo.choice_algo2.blast_type"
	#end if	
	
	-out "mainOutput.dat"

	##if $choice_algo.choice_algo2.algo_blast=="blastp":
                ##-task "$choice_algo.choice_algo2.blast_type"
        ##end if	
	
	##if $choice_algo.choice_algo2.algo_blast=="blastn":
                ##-task "$choice_algo.choice_algo2.blast_type"
        ##end if

	##if $choice_algo.choice_algo2.algo_blast=="tblastn":
                ##-task "$choice_algo.choice_algo2.blast_type"
        ##end if

	-evalue $choice_algo.choice_algo2.evalue_cutoff

	#if str($choice_algo.choice_algo2.output.out_format)=="ext":
		-outfmt \"6 std sallseqid score nident positive gaps ppos qframe sframe qseq sseq qlen slen salltitles\"
	#elif str($choice_algo.choice_algo2.output.out_format)=="cols"
	#set cols = (str($choice_algo.choice_algo2.output.std_cols)+","+str($choice_algo.choice_algo2.output.ext_cols)+","+str($choice_algo.choice_algo2.output.ids_cols)+","+str($choice_algo.choice_algo2.output.misc_cols)+","+str($choice_algo.choice_algo2.output.tax_cols)).replace("None", "").replace(",,", ",").replace(",", " ").strip()
	-outfmt "6 $cols"
	#else:
		-outfmt $choice_algo.choice_algo2.output.out_format
	#end if

	-num_threads "\${GALAXY_SLOTS:-8}"

	#if $choice_algo.choice_algo2.adv_opts.adv_opts_selector=="advanced":
		#if $choice_algo.choice_algo2.algo_blast=="blastn":
			$choice_algo.choice_algo2.adv_opts.strand
			#if (str($choice_algo.choice_algo2.adv_opts.identity_cutoff) and float(str($choice_algo.choice_algo2.adv_opts.identity_cutoff)) > 0 ):
				-perc_identity $choice_algo.choice_algo2.adv_opts.identity_cutoff
			#end if
			$choice_algo.choice_algo2.adv_opts.ungapped
		#end if

		#if $choice_algo.choice_algo2.algo_blast=="tblastn":
                        -matrix $choice_algo.choice_algo2.adv_opts.matrix
                #end if

		#if $choice_algo.choice_algo2.algo_blast=="blastp":
			-matrix $choice_algo.choice_algo2.adv_opts.matrix
		#end if

		#if $choice_algo.choice_algo2.algo_blast=="blastx":
			$choice_algo.choice_algo2.adv_opts.strand
                        -matrix $choice_algo.choice_algo2.adv_opts.matrix
			$choice_algo.choice_algo2.adv_opts.ungapped
                #end if

		#if $choice_algo.choice_algo2.algo_blast=="tblastx":
                	##-db_gencode $choice_algo.choice_algo2.adv_opts.db_gencode
			$choice_algo.choice_algo2.adv_opts.strand
			-matrix $choice_algo.choice_algo2.adv_opts.matrix
		#end if			

		$choice_algo.choice_algo2.adv_opts.filter_query
			
		#if (str($choice_algo.choice_algo2.adv_opts.max_hits) and int(str($choice_algo.choice_algo2.adv_opts.max_hits)) > 0):
			#if str($choice_algo.choice_algo2.output.out_format) in ["6", "ext", "cols", "5"]:
				-max_target_seqs $choice_algo.choice_algo2.adv_opts.max_hits
			#else
				-num_descriptions $adv_opts.max_hits -num_alignments $adv_opts.max_hits
			#end if
		#end if
		
		#if (str($choice_algo.choice_algo2.adv_opts.word_size) and int(str($choice_algo.choice_algo2.adv_opts.word_size)) > 0):
			-word_size $choice_algo.choice_algo2.adv_opts.word_size
		#end if
		$choice_algo.choice_algo2.adv_opts.parse_deflines
	
		#if $choice_algo.choice_algo2.adv_opts.adv_optional_id_files_opts.adv_optional_id_files_opts_selector == 'negative_gilist':
			-negative_gilist $choice_algo.choice_algo2.adv_opts.adv_optional_id_files_opts.negative_gilist
		#elif $choice_algo.choice_algo2.adv_opts.adv_optional_id_files_opts.adv_optional_id_files_opts_selector == 'gilist':
			-gilist $choice_algo.choice_algo2.adv_opts.adv_optional_id_files_opts.gilist
		#elif $choice_algo.choice_algo2.adv_opts.adv_optional_id_files_opts.adv_optional_id_files_opts_selector == 'seqidlist':
			-seqidlist $choice_algo.choice_algo2.adv_opts.adv_optional_id_files_opts.seqidlist
		#end if

		#if float(str($choice_algo.choice_algo2.adv_opts.qcov_hsp_perc)) &gt; 0:
    			-qcov_hsp_perc $choice_algo.choice_algo2.adv_opts.qcov_hsp_perc
		#end if

	
	#end if	

	#end if
	"$html_file"
	"$html_file.files_path"
	</command>
	

	<inputs>
	<conditional name="choice_algo">
                <param name="tool" type="select" label="Outils">
                        <option value="plast">Plast</option>
                        <option value="blast">Blast</option>
                </param>
		<when value="plast">
			<conditional name="choice_algo2">
				<param name="algo_plast" type="select" value="V2" label="Tardis">
					<option value="plastp">plastp</option>
					<option value="tplastx">tplastx</option>
					<option value="tplastn">tplastn</option>
					<option value="plastx">plastx</option>
					<option value="plastn">plastn</option>
				</param>
				<when value="plastp">
					<param name="query" type="data" format="fasta" label="Protein query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Protein BLAST database">
								<options from_file="blastdb_p.loc">
                      							<column name="value" index="0"/>
									<column name="name" index="1"/>
                      							<column name="path" index="2"/>
                    						</options>
                					</param>
                					<param name="histdb" type="hidden" value="" />
                					<param name="subject" type="hidden" value="" />
            					</when>
            					<when value="histdb">
                					<param name="database" type="hidden" value="" />
                					<param name="histdb" type="data" format="blastdbp" label="Protein BLAST database" />
                					<param name="subject" type="hidden" value="" />
            					</when>
            					<when value="file">
                					<param name="database" type="hidden" value="" />
                					<param name="histdb" type="hidden" value="" />
                					<param name="subject" type="data" format="fasta" label="Protein FASTA file to use as database"/>
            					</when>
					</conditional>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="E-value threshold" help="Every sequence alignment created by Plast having an E-value less than this threshold will be returned" />
					<param name="max_hits_query" type="integer" value="0" label="Maximum Hits / Query" help="Maximum number of hits created by Plast for each query. Use zero for default limits (500)">
						<validator type="in_range" min="0" />
					</param>	
					<param name="max_hsp_hits" type="integer" value="0" label="Maximum Hsp / Hits" help="Maximum number of HSPs created by Plast for each hit. Use zero for default limits (HSPs not filtered)">
						<validator type="in_range" min="0" />
					</param>
					<conditional name="ext_param">
						<param name="ext_param_selector" type="select" label="Extended parameters">
							<option value="basic" selected="True">Hide Extended parameters</option>
							<option value="extended">Show Extended parameters</option>
						</param>
						<when value="basic" />
						<when value="extended">
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-F T" falsevalue="-F F" checked="true" />
							<param name="matrix" type="select" label="Scoring matrix" help="Similarity matrix used by Plast to compare the two databanks">
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
							</param>
							<param name="gap_costs" type="select" label="Gap costs" help="Penalty costs used by Plast to create and extend gapped sequence alignments">
								<option value="-G 11 -E 2" selected="true">Open:11 Ext:2 (default)</option>
								<option value="-G 9 -E 2" >Open:9 Ext:2</option>
								<option value="-G 8 -E 2" >Open:8 Ext:2</option>
								<option value="-G 7 -E 2" >Open:7 Ext:2</option>
								<option value="-G 6 -E 2" >Open:6 Ext:2</option>
								<option value="-G 12 -E 1" >Open:12 Ext:1</option>
								<option value="-G 11 -E 1" >Open:11 Ext:1</option>
								<option value="-G 10 -E 1" >Open:10 Ext:1</option>
								<option value="-G 9 -E 1" >Open:9 Ext:1</option>
							</param>
						</when>
					</conditional>
					<conditional name="config_param">
						<param name="config_param_selector" type="select" label="Algorithm configuration parameters">
							<option value="basic" selected="True">Hide configuration parameters</option>
							<option value="advanced">Show configuration parameters</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="nb_threads" type="integer" value="8" label="Number of Threads" help="Number of core/threads to execute the Plast command">
								<validator type="in_range" min="0" />
							</param>		
							<param name="max_db_size" type="select" label="Maximum database size" help="Maximum allowed size (in bytes) for a database. If greater, the database is segmented.">
								<option value="20000000" selected="true">20MB (default)</option>
								<option value="50000000">50MB</option>
								<option value="100000000">100MB</option>
							</param>
							<param name="percent_seed" type="integer" value="1" label="Percent of seeds to use" help="Specify the amount of seeds used by Plast to scan a database. Default is 100%, meaning that Plast will use all seeds to scan the database. Using smaller value may produce similar results while reducing significantly search time">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_threshold_prot" type="integer" value="38" label="Ungap threshold" help="Threshold used to computing score to filter the ungap alignments. Default value is 38 for proteins">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_neighboors" type="integer" value="22" label="Ungap neighborhood" help="Set the seed neighborhoods size used to computed left and right score. Default value is 22">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_threshold" type="integer" value="54" label="Small gap threshold" help="Threshold used to computing score to filter alignments during the small gap algorithm. Default value is 54">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_bandwidth" type="integer" value="16" label="Small gap bandwidth" help="Set the bandwidth size used during the small gap algorithm. Default value is 16">
								<validator type="in_range" min="0" />
							</param>
						</when>
					</conditional>
				</when>
				<when value="plastx">
					<param name="query" type="data" format="fasta" label="Nucleotide query sequence(s)"/>
					<conditional name="db_opts">
            					<param name="db_opts_selector" type="select" label="Subject database/sequences">
              						<option value="db" selected="True">Locally installed BLAST database</option>
              						<option value="histdb">BLAST database from your history</option>
              						<option value="file">FASTA file from your history (see warning note below)</option>
            					</param>
            					<when value="db">
                					<param name="database" type="select" label="Protein BLAST database">
                    						<options from_file="blastdb_p.loc">
                      							<column name="value" index="0"/>
                      							<column name="name" index="1"/>
									<column name="path" index="2"/>
								</options>
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbp" label="Protein BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Protein FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="E-value threshold" help="Every sequence alignment created by Plast having an E-value less than this threshold will be returned" />
					<param name="max_hits_query" type="integer" value="0" label="Maximum Hits / Query" help="Maximum number of hits created by Plast for each query. Use zero for default limits (500)">
						<validator type="in_range" min="0" />
					</param>
					<param name="max_hsp_hits" type="integer" value="0" label="Maximum Hsp / Hits" help="Maximum number of HSPs created by Plast for each hit. Use zero for default limits (HSPs not filtered)">
						<validator type="in_range" min="0" />
					</param>	
					<conditional name="ext_param">
						<param name="ext_param_selector" type="select" label="Extended parameters">
							<option value="basic" selected="True">Hide Extended parameters</option>
							<option value="extended">Show Extended parameters</option>
						</param>
						<when value="basic" />
						<when value="extended">
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-F T" falsevalue="-F F" checked="true"     />
							<param name="matrix" type="select" label="Scoring matrix" help="Similarity matrix used by Plast to compare the two databanks">
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
							</param>
							<param name="gap_costs" type="select" label="Gap costs" help="Penalty costs used by Plast to create and extend gapped sequence alignments">
								<option value="-G 11 -E 2" selected="true">Open:11 Ext:2 (default)</option>
								<option value="-G 9 -E 2" >Open:9 Ext:2</option>
								<option value="-G 8 -E 2" >Open:8 Ext:2</option>
								<option value="-G 7 -E 2" >Open:7 Ext:2</option>
								<option value="-G 6 -E 2" >Open:6 Ext:2</option>
								<option value="-G 12 -E 1" >Open:12 Ext:1</option>
								<option value="-G 11 -E 1" >Open:11 Ext:1</option>
								<option value="-G 10 -E 1" >Open:10 Ext:1</option>
								<option value="-G 9 -E 1" >Open:9 Ext:1</option>
							</param>
						</when>
					</conditional>	
					<conditional name="config_param">
						<param name="config_param_selector" type="select" label="Algorithm configuration parameters">
							<option value="basic" selected="True">Hide configuration parameters</option>
							<option value="advanced">Show configuration parameters</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="nb_threads" type="integer" value="8" label="Number of Threads" help="Number of core/threads to execute the Plast command">
								<validator type="in_range" min="0" />
							</param>
							<param name="max_db_size" type="select" label="Maximum database size" help="Maximum allowed size (in bytes) for a database. If greater, the datab    ase is segmented.">
								<option value="20000000" selected="true">20MB (default)</option>
								<option value="50000000">50MB</option>
								<option value="100000000">100MB</option>
							</param>
							<param name="percent_seed" type="integer" value="1" label="Percent of seeds to use" help="Specify the amount of seeds used by Plast to scan a dat    abase. Default is 100%, meaning that Plast will use all seeds to scan the database. Using smaller value may produce similar results while reducing significantly search time">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_threshold_prot" type="integer" value="38" label="Ungap threshold" help="Threshold used to computing score to filter the ungap     alignments. Default value is 38 for proteins">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_neighboors" type="integer" value="22" label="Ungap neighborhood" help="Set the seed neighborhoods size used to computed left a    nd right score. Default value is 22">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_threshold" type="integer" value="54" label="Small gap threshold" help="Threshold used to computing score to filter alignmen    ts during the small gap algorithm. Default value is 54">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_bandwidth" type="integer" value="16" label="Small gap bandwidth" help="Set the bandwidth size used during the small gap alg    orithm. Default value is 16">
								<validator type="in_range" min="0" />
							</param>
						</when>
					</conditional>
				</when>
				<when value="plastn">
					<param name="query" type="data" format="fasta" label="Nucleotide query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
                					<param name="database" type="select" label="Nucleotide BLAST database">
                    						<options from_file="blastdb.loc">
									<column name="value" index="0"/>
									<column name="name" index="1"/>
									<column name="path" index="2"/>
								</options>
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="E-value threshold" help="Every sequence alignment created by Plast having an E-value less than this threshold will be returned" />
					 <param name="max_hits_query" type="integer" value="0" label="Maximum Hits / Query" help="Maximum number of hits created by Plast for each query. Use zero for default limits (500)">
						<validator type="in_range" min="0" />
					</param>						
					<param name="max_hsp_hits" type="integer" value="0" label="Maximum Hsp / Hits" help="Maximum number of HSPs created by Plast for each hit. Use zero for default limits (HSPs not filtered)">
						<validator type="in_range" min="0" />
					</param>
					<conditional name="ext_param">
						<param name="ext_param_selector" type="select" label="Extended parameters">
							<option value="basic" selected="True">Hide Extended parameters</option>
							<option value="extended">Show Extended parameters</option>
						</param>
						<when value="basic" />
						<when value="extended">
            						<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-F T" falsevalue="-F F" checked="true" />
							<param name="strand" type="select" label="Query strand(s)" help="Query strand(s) to search against database/subject">
								<option value="-strand both" selected="true">Both (default)</option>
								<option value="-strand plus">Plus (forward)</option>
								<option value="-strand minus">Minus (reverse complement)</option>
							</param>
							<param name="match_mismatch" type="select" label="Match/Mismatch" help="Reward and penalty for matching and mismatching bases">
								<option value="-r 1 -q -1" >Match:1 Mismatch:-1 </option>
								<option value="-r 1 -q -2" >Match:1 Mismatch:-2 </option>
								<option value="-r 1 -q -3" >Match:1 Mismatch:-3 </option>
								<option value="-r 1 -q -4" >Match:1 Mismatch:-4 </option>
								<option value="-r 2 -q -3" selected="true" >Match:2 Mismatch:-3 (default)</option>
								<option value="-r 4 -q -5" >Match:4 Mismatch:-5 </option>
							</param>
						</when>
        				</conditional>
					<conditional name="config_param">
						<param name="config_param_selector" type="select" label="Algorithm configuration parameters">
							<option value="basic" selected="True">Hide configuration parameters</option>
							<option value="advanced">Show configuration parameters</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="nb_threads" type="integer" value="8" label="Number of Threads" help="Number of core/threads to execute the Plast command">
								<validator type="in_range" min="0" />
							</param>
							<param name="max_db_size" type="select" label="Maximum database size" help="Maximum allowed size (in bytes) for a database. If greater, the database is segmented.">
								<option value="20000000" selected="true">20MB (default)</option>
								<option value="50000000">50MB</option>
								<option value="100000000">100MB</option>
							</param>
							<param name="ungap_threshold_prot" type="integer" value="38" label="Ungap threshold" help="Threshold used to computing score to filter the ungap alignments. Default value is 38 for proteins">
								<validator type="in_range" min="0" />
							</param>
							 <param name="ungap_Xdrop" type="integer" value="20" label="Ungap Xdrop" help="Xdrop value used to filter alignments during the ungap algorithm. Default value is 20">
								<validator type="in_range" min="0" />
							</param>
							<param name="final_gap_Xdrop" type="integer" value="100" label="Final gap Xdrop" help="Xdrop value used to filter alignments during the final gap algorithm. Equivalent to blast -Z parameter. . Default value is 100">
								<validator type="in_range" min="0" />
							</param>
						</when>
					</conditional>
				</when>
				<when value="tplastn">
					<param name="query" type="data" format="fasta" label="Protein query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Nucleotide BLAST database">
								<options from_file="blastdb.loc">
									<column name="value" index="0"/>
									<column name="name" index="1"/>
									<column name="path" index="2"/>
								</options>
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="E-value threshold" help="Every sequence alignment created by Plast having an E-value less than this threshold will be returned" />
					<param name="max_hits_query" type="integer" value="0" label="Maximum Hits / Query" help="Maximum number of hits created by Plast for each query. Use zero for default limits (500)">
						<validator type="in_range" min="0" />
					</param>
					<param name="max_hsp_hits" type="integer" value="0" label="Maximum Hsp / Hits" help="Maximum number of HSPs created by Plast for each hit. Use zero for default limits (HSPs not filtered)">
						<validator type="in_range" min="0" />
					</param>
					<conditional name="ext_param">
						<param name="ext_param_selector" type="select" label="Extended parameters">
							<option value="basic" selected="True">Hide Extended parameters</option>
							<option value="extended">Show Extended parameters</option>
						</param>
						<when value="basic" />
						<when value="extended">
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-F T" falsevalue="-F F" checked="true"         />
							<param name="matrix" type="select" label="Scoring matrix" help="Similarity matrix used by Plast to compare the two databanks">
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
							</param>
							<param name="gap_costs" type="select" label="Gap costs" help="Penalty costs used by Plast to create and extend gapped sequence alignments">
								<option value="-G 11 -E 2" selected="true">Open:11 Ext:2 (default)</option>
								<option value="-G 9 -E 2" >Open:9 Ext:2</option>
								<option value="-G 8 -E 2" >Open:8 Ext:2</option>
								<option value="-G 7 -E 2" >Open:7 Ext:2</option>
								<option value="-G 6 -E 2" >Open:6 Ext:2</option>
								<option value="-G 12 -E 1" >Open:12 Ext:1</option>
								<option value="-G 11 -E 1" >Open:11 Ext:1</option>
								<option value="-G 10 -E 1" >Open:10 Ext:1</option>
								<option value="-G 9 -E 1" >Open:9 Ext:1</option>
							</param>
						</when>
					</conditional>
					<conditional name="config_param">
						<param name="config_param_selector" type="select" label="Algorithm configuration parameters">
							<option value="basic" selected="True">Hide configuration parameters</option>
							<option value="advanced">Show configuration parameters</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="nb_threads" type="integer" value="8" label="Number of Threads" help="Number of core/threads to execute the Plast command">
								<validator type="in_range" min="0" />
							</param>
							<param name="max_db_size" type="select" label="Maximum database size" help="Maximum allowed size (in bytes) for a database. If greater, the database is segmented.">
								<option value="20000000" selected="true">20MB (default)</option>
								<option value="50000000">50MB</option>
								<option value="100000000">100MB</option>
							</param>
							<param name="percent_seed" type="integer" value="1" label="Percent of seeds to use" help="Specify the amount of seeds used by Plast to scan a database. Default is 100%, meaning that Plast will use all seeds to scan the database. Using smaller value may produce similar results while reducing significantly search time">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_threshold_prot" type="integer" value="38" label="Ungap threshold" help="Threshold used to computing score to filter the ungap alignments. Default value is 38 for proteins">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_neighboors" type="integer" value="22" label="Ungap neighborhood" help="Set the seed neighborhoods size used to computed left and right score. Default value is 22">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_threshold" type="integer" value="54" label="Small gap threshold" help="Threshold used to computing score to filter alignements during the small gap algorithm. Default value is 54">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_bandwidth" type="integer" value="16" label="Small gap bandwidth" help="Set the bandwidth size used during the small gap algorithm. Default value is 16">
								<validator type="in_range" min="0" />
							</param>
						</when>
					</conditional>
				</when>
				<when value="tplastx">
					<param name="query" type="data" format="fasta" label="Nucleotide query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Nucleotide BLAST database">
								<options from_file="blastdb.loc">
									<column name="value" index="0"/>
									<column name="name" index="1"/>
									<column name="path" index="2"/>
								</options>
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="E-value threshold" help="Every sequence alignment created by Plast having an E-value less than this threshold will be returned" />
					<param name="max_hits_query" type="integer" value="0" label="Maximum Hits / Query" help="Maximum number of hits created by Plast for each query. Use zero for default limits (500)">
						<validator type="in_range" min="0" />
					</param>
					<param name="max_hsp_hits" type="integer" value="0" label="Maximum Hsp / Hits" help="Maximum number of HSPs created by Plast for each hit. Use zero for default limits (HSPs not filtered)">
						<validator type="in_range" min="0" />
					</param>
					<conditional name="ext_param">
						<param name="ext_param_selector" type="select" label="Extended parameters">
							<option value="basic" selected="True">Hide Extended parameters</option>
							<option value="extended">Show Extended parameters</option>
						</param>
						<when value="basic" />
						<when value="extended">
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-F T" falsevalue="-F F" checked="true"/>
							<param name="matrix" type="select" label="Scoring matrix" help="Similarity matrix used by Plast to compare the two databanks">
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
							</param>
							<param name="gap_costs" type="select" label="Gap costs" help="Penalty costs used by Plast to create and extend gapped sequence alignments">
								<option value="-G 11 -E 2" selected="true">Open:11 Ext:2 (default)</option>
								<option value="-G 9 -E 2" >Open:9 Ext:2</option>
								<option value="-G 8 -E 2" >Open:8 Ext:2</option>
								<option value="-G 7 -E 2" >Open:7 Ext:2</option>
								<option value="-G 6 -E 2" >Open:6 Ext:2</option>
								<option value="-G 12 -E 1" >Open:12 Ext:1</option>
								<option value="-G 11 -E 1" >Open:11 Ext:1</option>
								<option value="-G 10 -E 1" >Open:10 Ext:1</option>
								<option value="-G 9 -E 1" >Open:9 Ext:1</option>
							</param>
						</when>
					</conditional>
					<conditional name="config_param">
						<param name="config_param_selector" type="select" label="Algorithm configuration parameters">
							<option value="basic" selected="True">Hide configuration parameters</option>
							<option value="advanced">Show configuration parameters</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="nb_threads" type="integer" value="8" label="Number of Threads" help="Number of core/threads to execute the Plast command">
								<validator type="in_range" min="0" />
							</param>
							<param name="max_db_size" type="select" label="Maximum database size" help="Maximum allowed size (in bytes) for a database. If greater, the database is segmented.">
								<option value="20000000" selected="true">20MB (default)</option>
								<option value="50000000">50MB</option>
								<option value="100000000">100MB</option>
							</param>
							<param name="percent_seed" type="integer" value="1" label="Percent of seeds to use" help="Specify the amount of seeds used by Plast to scan a database. Default is 100%, meaning that Plast will use all seeds to scan the database. Using smaller value may produce similar results while reducing significantly search time">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_threshold_prot" type="integer" value="38" label="Ungap threshold" help="Threshold used to computing score to filter the ungap alignments. Default value is 38 for proteins">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungap_neighboors" type="integer" value="22" label="Ungap neighborhood" help="Set the seed neighborhoods size used to computed left and right score. Default value is 22">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_threshold" type="integer" value="54" label="Small gap threshold" help="Threshold used to computing score to filter alignments during the small gap algorithm. Default value is 54">
								<validator type="in_range" min="0" />
							</param>
							<param name="smallgap_bandwidth" type="integer" value="16" label="Small gap bandwidth" help="Set the bandwidth size used during the small gap algorithm. Default value is 16">
								<validator type="in_range" min="0" />
							</param>
						</when>
					</conditional>
				</when>
			</conditional>
		</when>
		<when value="blast">
			<conditional name="choice_algo2">
				<param name="algo_blast" type="select" value="V2" label="Outil">
                                        <option value="blastp">blastp</option>
                                        <option value="blastn">blastn</option>
                                        <option value="tblastx">tblastx</option>
                                        <option value="blastx">blastx</option>
                                        <option value="tblastn">tblastn</option>
                                </param>
				
				<when value="blastp">
					<param name="query" type="data" format="fasta" label="Protein query sequence(s)"/>

					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Nucleotide BLAST database">
								<options from_data_table="blastdb" />
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
        				</conditional>
					
					<param name="blast_type" type="select" display="radio" label="Type of BLAST">
						<option value="blastp">blastp - Traditional BLASTP to compare a protein query to a protein database</option>
						<option value="blastp-fast">blastp-fast - Use longer words for seeding, faster but less accurate</option>
						<option value="blastp-short">blastp-short - BLASTP optimized for queries shorter than 30 residues</option>
					</param>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="Set expectation value cutoff" />
					<conditional name="output">
						<param name="out_format" type="select" label="Output format">
							<!-- [NON DISPONIBLE] <option value="6">Tabular (standard 12 columns)</option> -->
							<option value="ext" selected="True">Tabular (extended 25 columns)</option>
							<!-- [NON DISPONIBLE] <option value="cols">Tabular (select which columns)</option> -->
							<!-- [NON DISPONIBLE] <option value="5">BLAST XML</option> -->
							<!-- [NON DISPONIBLE] <option value="0">Pairwise text</option> -->
							<!-- [NON DISPONIBLE] <option value="0 -html">Pairwise HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="2">Query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="2 -html">Query-anchored HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="4">Flat query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="4 -html">Flat query-anchored HTML</option> -->
						</param>
						<when value="6"/>
						<when value="ext"/>
						<when value="cols">
							<param name="std_cols" type="select" multiple="true" display="checkboxes" label="Standard columns">
								<option selected="true" value="qseqid">qseqid = Query Seq-id (ID of your sequence)</option>
								<option selected="true" value="sseqid">sseqid = Subject Seq-id (ID of the database hit)</option>
								<option selected="true" value="pident">pident = Percentage of identical matches</option>
								<option selected="true" value="length">length = Alignment length</option>
								<option selected="true" value="mismatch">mismatch = Number of mismatches</option>
								<option selected="true" value="gapopen">gapopen = Number of gap openings</option>
								<option selected="true" value="qstart">qstart = Start of alignment in query</option>
								<option selected="true" value="qend">qend = End of alignment in query</option>
								<option selected="true" value="sstart">sstart = Start of alignment in subject (database hit)</option>
								<option selected="true" value="send">send = End of alignment in subject (database hit)</option>
								<option selected="true" value="evalue">evalue = Expectation value (E-value)</option>
								<option selected="true" value="bitscore">bitscore = Bit score</option>
							</param>
							<param name="ext_cols" type="select" multiple="true" display="checkboxes" label="Extended columns">
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="score">score = Raw score</option>
								<option value="nident">nident = Number of identical matches</option>
								<option value="positive">positive = Number of positive-scoring matches</option>
								<option value="gaps">gaps = Total number of gaps</option>
								<option value="ppos">ppos = Percentage of positive-scoring matches</option>
								<option value="qframe">qframe = Query frame</option>
								<option value="sframe">sframe = Subject frame</option>
								<option value="qseq">qseq = Aligned part of query sequence</option>
								<option value="sseq">sseq = Aligned part of subject sequence</option>
								<option value="qlen">qlen = Query sequence length</option>
								<option value="slen">slen = Subject sequence length</option>
								<option value="salltitles">salltitles = All subject title(s), separated by a '&lt;&gt;'</option>
							</param>
							<param name="ids_cols" type="select" multiple="true" display="checkboxes" label="Other identifier columns">
								<option value="qgi">qgi = Query GI</option>
								<option value="qacc">qacc = Query accesion</option>
								<option value="qaccver">qaccver = Query accesion.version</option>
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="sgi">sgi = Subject GI</option>
								<option value="sallgi">sallgi = All subject GIs</option>
								<option value="sacc">sacc = Subject accession</option>
								<option value="saccver">saccver = Subject accession.version</option>
								<option value="sallacc">sallacc = All subject accessions</option>
								<option value="stitle">stitle = Subject Title</option>
							</param>
							<param name="misc_cols" type="select" multiple="true" display="checkboxes" label="Miscellaneous columns">
								<option value="sstrand">sstrand = Subject Strand</option>
								<option value="frames">frames = Query and subject frames separated by a '/'</option>
								<option value="btop">btop = Blast traceback operations (BTOP)</option>
								<option value="qcovs">qcovs = Query Coverage Per Subject</option>
								<option value="qcovhsp">qcovhsp = Query Coverage Per HSP</option>
							</param>
							<param name="tax_cols" type="select" multiple="true" display="checkboxes" label="Taxonomy columns">
								<option value="staxids">staxids = unique Subject Taxonomy ID(s), separated by a ';' (in numerical order)</option>
								<option value="sscinames">sscinames = unique Subject Scientific Name(s), separated by a ';'</option>
								<option value="scomnames">scomnames = unique Subject Common Name(s), separated by a ';'</option>
								<option value="sblastnames">sblastnames = unique Subject Blast Name(s), separated by a ';' (in alphabetical order)</option>
								<option value="sskingdoms">sskingdoms = unique Subject Super Kingdom(s), separated by a ';' (in alphabetical order)</option>
							</param>
						</when>
						<when value="5"/>
						<when value="0"/>
						<when value="0 -html"/>
						<when value="2"/>
						<when value="2 -html"/>
						<when value="4"/>
						<when value="4 -html"/>
					</conditional>
					<conditional name="adv_opts">
						<param name="adv_opts_selector" type="select" label="Advanced Options">
							<option value="basic" selected="True">Hide Advanced Options</option>
							<option value="advanced">Show Advanced Options</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-seg yes" falsevalue="-seg no" checked="false" />
							<param name="matrix" type="select" label="Scoring matrix">
								<!-- [NON DISPONIBLE] <option value="BLOSUM90">BLOSUM90</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM80">BLOSUM80</option> -->
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM45">BLOSUM45</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM250">PAM250</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM70">PAM70</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM30">PAM30</option> -->
							</param>
							<param name="max_hits" type="integer" value="0" label="Maximum hits to show" help="Use zero for default limits">
								<validator type="in_range" min="0" />
							</param>
							<param name="word_size" type="integer" value="0" label="Word size for wordfinder algorithm" help="Use zero for default, otherwise minimum 2.">
            							<validator type="in_range" min="0" />
							</param>
							<param name="parse_deflines" type="boolean" label="Should the query and subject defline(s) be parsed?" truevalue="-parse_deflines" falsevalue="" checked="false" help="This affects the formatting of the query/subject ID strings"/>
							
							<conditional name="adv_optional_id_files_opts">
								<param name="adv_optional_id_files_opts_selector" type="select" label="Restrict search of database to a given set of ID's" help="This feature provides a means to exclude ID's from a BLAST database search. The expectation values in the BLAST results are based upon the sequences actually searched, and not on the underlying database. Note this cannot be used when comparing against a FASTA file.">
									<option value="none" selected="True">No restriction, search the entire database</option>
									<option value="gilist">GI identifiers</option>
									<option value="negative_gilist">Negative GI identifiers</option>
									<option value="seqidlist">Sequence identifiers (SeqId's)</option>
								</param>
								<when value="none" />
								<when value="gilist">
									<param name="gilist" type="data" format="txt" label="Restrict search of database to GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="negative_gilist">
									<param name="negative_gilist" type="data" format="txt" label="Restrict search of database to everything except the GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="seqidlist">
									<param name="seqidlist" type="data" format="txt" label=" Restrict search of database to list of SeqId's" help="This option is only available for database searches."/>
								</when>
							</conditional>
							<param name="qcov_hsp_perc" type="float" value="0" min="0" max="100" label="Minimum query coverage per hsp (percentage, 0 to 100)" help="See also the output column qhspcov"/>

						</when>
					</conditional>
				</when>
				<when value="blastn">
					<param name="query" type="data" format="fasta" label="Nucleotide query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Nucleotide BLAST database">
								<options from_data_table="blastdb" />
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="blast_type" type="select" display="radio" label="Type of BLAST">
						<option value="megablast">megablast - Traditional megablast used to find very similar (e.g., intraspecies or closely related species) sequences</option>
						<option value="blastn">blastn - Traditional BLASTN requiring an exact match of 11, for somewhat similar sequences</option>
						<option value="blastn-short">blastn-short - BLASTN program optimized for sequences shorter than 50 bases</option>
						<option value="dc-megablast">dc-megablast - Discontiguous megablast used to find more distant (e.g., interspecies) sequences</option>
        				</param>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="Set expectation value cutoff" />
					
					<conditional name="output">
						<param name="out_format" type="select" label="Output format">
							<!-- [NON DISPONIBLE] <option value="6">Tabular (standard 12 columns)</option> -->
							<option value="ext" selected="True">Tabular (extended 25 columns)</option>
							<!-- [NON DISPONIBLE] <option value="cols">Tabular (select which columns)</option> -->
							<!-- [NON DISPONIBLE] <option value="5">BLAST XML</option> -->
							<!-- [NON DISPONIBLE] <option value="0">Pairwise text</option> -->
							<!-- [NON DISPONIBLE] <option value="0 -html">Pairwise HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="2">Query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="2 -html">Query-anchored HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="4">Flat query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="4 -html">Flat query-anchored HTML</option> -->
						</param>
						<when value="6"/>
						<when value="ext"/>
						<when value="cols">
							<param name="std_cols" type="select" multiple="true" display="checkboxes" label="Standard columns">
								<option selected="true" value="qseqid">qseqid = Query Seq-id (ID of your sequence)</option>
								<option selected="true" value="sseqid">sseqid = Subject Seq-id (ID of the database hit)</option>
								<option selected="true" value="pident">pident = Percentage of identical matches</option>
								<option selected="true" value="length">length = Alignment length</option>
								<option selected="true" value="mismatch">mismatch = Number of mismatches</option>
								<option selected="true" value="gapopen">gapopen = Number of gap openings</option>
								<option selected="true" value="qstart">qstart = Start of alignment in query</option>
								<option selected="true" value="qend">qend = End of alignment in query</option>
								<option selected="true" value="sstart">sstart = Start of alignment in subject (database hit)</option>
								<option selected="true" value="send">send = End of alignment in subject (database hit)</option>
								<option selected="true" value="evalue">evalue = Expectation value (E-value)</option>
								<option selected="true" value="bitscore">bitscore = Bit score</option>
							</param>
							<param name="ext_cols" type="select" multiple="true" display="checkboxes" label="Extended columns">
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="score">score = Raw score</option>
								<option value="nident">nident = Number of identical matches</option>
								<option value="positive">positive = Number of positive-scoring matches</option>
								<option value="gaps">gaps = Total number of gaps</option>
								<option value="ppos">ppos = Percentage of positive-scoring matches</option>
								<option value="qframe">qframe = Query frame</option>
								<option value="sframe">sframe = Subject frame</option>
								<option value="qseq">qseq = Aligned part of query sequence</option>
								<option value="sseq">sseq = Aligned part of subject sequence</option>
								<option value="qlen">qlen = Query sequence length</option>
								<option value="slen">slen = Subject sequence length</option>
								<option value="salltitles">salltitles = All subject title(s), separated by a '&lt;&gt;'</option>
							</param>
							<param name="ids_cols" type="select" multiple="true" display="checkboxes" label="Other identifier columns">
								<option value="qgi">qgi = Query GI</option>
								<option value="qacc">qacc = Query accesion</option>
								<option value="qaccver">qaccver = Query accesion.version</option>
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="sgi">sgi = Subject GI</option>
								<option value="sallgi">sallgi = All subject GIs</option>
								<option value="sacc">sacc = Subject accession</option>
								<option value="saccver">saccver = Subject accession.version</option>
								<option value="sallacc">sallacc = All subject accessions</option>
								<option value="stitle">stitle = Subject Title</option>
							</param>
							<param name="misc_cols" type="select" multiple="true" display="checkboxes" label="Miscellaneous columns">
								<option value="sstrand">sstrand = Subject Strand</option>
								<option value="frames">frames = Query and subject frames separated by a '/'</option>
								<option value="btop">btop = Blast traceback operations (BTOP)</option>
								<option value="qcovs">qcovs = Query Coverage Per Subject</option>
								<option value="qcovhsp">qcovhsp = Query Coverage Per HSP</option>
							</param>
							<param name="tax_cols" type="select" multiple="true" display="checkboxes" label="Taxonomy columns">
								<option value="staxids">staxids = unique Subject Taxonomy ID(s), separated by a ';' (in numerical order)</option>
								<option value="sscinames">sscinames = unique Subject Scientific Name(s), separated by a ';'</option>
								<option value="scomnames">scomnames = unique Subject Common Name(s), separated by a ';'</option>
								<option value="sblastnames">sblastnames = unique Subject Blast Name(s), separated by a ';' (in alphabetical order)</option>
								<option value="sskingdoms">sskingdoms = unique Subject Super Kingdom(s), separated by a ';' (in alphabetical order)</option>
							</param>
						</when>
						<when value="5"/>
						<when value="0"/>
						<when value="0 -html"/>
						<when value="2"/>
						<when value="2 -html"/>
						<when value="4"/>
						<when value="4 -html"/>
					</conditional>
					<conditional name="adv_opts">
						<param name="adv_opts_selector" type="select" label="Advanced Options">
							<option value="basic" selected="True">Hide Advanced Options</option>
							<option value="advanced">Show Advanced Options</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with DUST)" truevalue="-dust yes" falsevalue="-dust no" checked="true" />
							<param name="strand" type="select" label="Query strand(s) to search against database/subject">
								<option value="-strand both">Both</option>
								<option value="-strand plus">Plus (forward)</option>
								<option value="-strand minus">Minus (reverse complement)</option>
							</param>
							<param name="max_hits" type="integer" value="0" label="Maximum hits to show" help="Use zero for default limits">
								<validator type="in_range" min="0" />
							</param>
							<param name="identity_cutoff" type="float" min="0" max="100" value="0" label="Percent identity cutoff (-perc_identity)" help="Use zero for no cutoff" />
							<param name="word_size" type="integer" value="0" label="Word size for wordfinder algorithm" help="Use zero for default, otherwise minimum 4.">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungapped" type="boolean" label="Perform ungapped alignment only?" truevalue="-ungapped" falsevalue="" checked="false" />
							<param name="parse_deflines" type="boolean" label="Should the query and subject defline(s) be parsed?" truevalue="-parse_deflines" falsevalue="" checked="false" help="This affects the formatting of the query/subject ID strings"/>
							<conditional name="adv_optional_id_files_opts">
								<param name="adv_optional_id_files_opts_selector" type="select" label="Restrict search of database to a given set of ID's" help="This feature provides a means to exclude ID's from a BLAST database search. The expectation values in the BLAST results are based upon the sequences actually searched, and not on the underlying database. Note this cannot be used when comparing against a FASTA file.">
									<option value="none" selected="True">No restriction, search the entire database</option>
									<option value="gilist">GI identifiers</option>
									<option value="negative_gilist">Negative GI identifiers</option>
									<option value="seqidlist">Sequence identifiers (SeqId's)</option>
            							</param>
								<when value="none" />
								<when value="gilist">
									<param name="gilist" type="data" format="txt" label="Restrict search of database to GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="negative_gilist">
									<param name="negative_gilist" type="data" format="txt" label="Restrict search of database to everything except the GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="seqidlist">
									<param name="seqidlist" type="data" format="txt" label=" Restrict search of database to list of SeqId's" help="This option is only available for database searches."/>
								</when>
							</conditional>
							<param name="qcov_hsp_perc" type="float" value="0" min="0" max="100" label="Minimum query coverage per hsp (percentage, 0 to 100)" help="See also the output column qhspcov"/>

						</when>
					</conditional>
				</when>
				<when value="tblastx">
					<param name="query" type="data" format="fasta" label="Nucleotide query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Nucleotide BLAST database">
								<options from_data_table="blastdb" />
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="query_gencode" type="select" label="Query genetic code">
					<!-- See http://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi for details -->
						<option value="1" select="True">1. Standard</option>
						<option value="2">2. Vertebrate Mitochondrial</option>
						<option value="3">3. Yeast Mitochondrial</option>
						<option value="4">4. Mold, Protozoan, and Coelenterate Mitochondrial Code and the Mycoplasma/Spiroplasma Code</option>
						<option value="5">5. Invertebrate Mitochondrial</option>
						<option value="6">6. Ciliate, Dasycladacean and Hexamita Nuclear Code</option>
						<option value="9">9. Echinoderm Mitochondrial</option>
						<option value="10">10. Euplotid Nuclear</option>
						<option value="11">11. Bacteria and Archaea</option>
						<option value="12">12. Alternative Yeast Nuclear</option>
						<option value="13">13. Ascidian Mitochondrial</option>
						<option value="14">14. Flatworm Mitochondrial</option>
						<option value="15">15. Blepharisma Macronuclear</option>
						<option value="16">16. Chlorophycean Mitochondrial Code</option>
						<option value="21">21. Trematode Mitochondrial Code</option>
						<option value="22">22. Scenedesmus obliquus mitochondrial Code</option>
						<option value="23">23. Thraustochytrium Mitochondrial Code</option>
						<option value="24">24. Pterobranchia mitochondrial code</option>
					</param>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="Set expectation value cutoff" />
					<conditional name="output">
						<param name="out_format" type="select" label="Output format">
							<!-- [NON DISPONIBLE] <option value="6">Tabular (standard 12 columns)</option> -->
							<option value="ext" selected="True">Tabular (extended 25 columns)</option>
							<!-- [NON DISPONIBLE] <option value="cols">Tabular (select which columns)</option> -->
							<!-- [NON DISPONIBLE] <option value="5">BLAST XML</option> -->
							<!-- [NON DISPONIBLE] <option value="0">Pairwise text</option> -->
							<!-- [NON DISPONIBLE] <option value="0 -html">Pairwise HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="2">Query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="2 -html">Query-anchored HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="4">Flat query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="4 -html">Flat query-anchored HTML</option> -->
						</param>
						<when value="6"/>
						<when value="ext"/>
						<when value="cols">
							<param name="std_cols" type="select" multiple="true" display="checkboxes" label="Standard columns">
								<option selected="true" value="qseqid">qseqid = Query Seq-id (ID of your sequence)</option>
								<option selected="true" value="sseqid">sseqid = Subject Seq-id (ID of the database hit)</option>
								<option selected="true" value="pident">pident = Percentage of identical matches</option>
								<option selected="true" value="length">length = Alignment length</option>
								<option selected="true" value="mismatch">mismatch = Number of mismatches</option>
								<option selected="true" value="gapopen">gapopen = Number of gap openings</option>
								<option selected="true" value="qstart">qstart = Start of alignment in query</option>
								<option selected="true" value="qend">qend = End of alignment in query</option>
								<option selected="true" value="sstart">sstart = Start of alignment in subject (database hit)</option>
								<option selected="true" value="send">send = End of alignment in subject (database hit)</option>
								<option selected="true" value="evalue">evalue = Expectation value (E-value)</option>
								<option selected="true" value="bitscore">bitscore = Bit score</option>
							</param>
							<param name="ext_cols" type="select" multiple="true" display="checkboxes" label="Extended columns">
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="score">score = Raw score</option>
								<option value="nident">nident = Number of identical matches</option>
								<option value="positive">positive = Number of positive-scoring matches</option>
								<option value="gaps">gaps = Total number of gaps</option>
								<option value="ppos">ppos = Percentage of positive-scoring matches</option>
								<option value="qframe">qframe = Query frame</option>
								<option value="sframe">sframe = Subject frame</option>
								<option value="qseq">qseq = Aligned part of query sequence</option>
								<option value="sseq">sseq = Aligned part of subject sequence</option>
								<option value="qlen">qlen = Query sequence length</option>
								<option value="slen">slen = Subject sequence length</option>
								<option value="salltitles">salltitles = All subject title(s), separated by a '&lt;&gt;'</option>
							</param>
							<param name="ids_cols" type="select" multiple="true" display="checkboxes" label="Other identifier columns">
								<option value="qgi">qgi = Query GI</option>
								<option value="qacc">qacc = Query accesion</option>
								<option value="qaccver">qaccver = Query accesion.version</option>
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="sgi">sgi = Subject GI</option>
								<option value="sallgi">sallgi = All subject GIs</option>
								<option value="sacc">sacc = Subject accession</option>
								<option value="saccver">saccver = Subject accession.version</option>
								<option value="sallacc">sallacc = All subject accessions</option>
								<option value="stitle">stitle = Subject Title</option>
							</param>
							<param name="misc_cols" type="select" multiple="true" display="checkboxes" label="Miscellaneous columns">
								<option value="sstrand">sstrand = Subject Strand</option>
								<option value="frames">frames = Query and subject frames separated by a '/'</option>
								<option value="btop">btop = Blast traceback operations (BTOP)</option>
								<option value="qcovs">qcovs = Query Coverage Per Subject</option>
								<option value="qcovhsp">qcovhsp = Query Coverage Per HSP</option>
							</param>
							<param name="tax_cols" type="select" multiple="true" display="checkboxes" label="Taxonomy columns">
								<option value="staxids">staxids = unique Subject Taxonomy ID(s), separated by a ';' (in numerical order)</option>
								<option value="sscinames">sscinames = unique Subject Scientific Name(s), separated by a ';'</option>
								<option value="scomnames">scomnames = unique Subject Common Name(s), separated by a ';'</option>
								<option value="sblastnames">sblastnames = unique Subject Blast Name(s), separated by a ';' (in alphabetical order)</option>
								<option value="sskingdoms">sskingdoms = unique Subject Super Kingdom(s), separated by a ';' (in alphabetical order)</option>
							</param>
						</when>
						<when value="5"/>
						<when value="0"/>
						<when value="0 -html"/>
						<when value="2"/>
						<when value="2 -html"/>
						<when value="4"/>
						<when value="4 -html"/>
					</conditional>
					<conditional name="adv_opts">
						<param name="adv_opts_selector" type="select" label="Advanced Options">
							<option value="basic" selected="True">Hide Advanced Options</option>
							<option value="advanced">Show Advanced Options</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="query_gencode" type="select" label="Query genetic code">
							<!-- See http://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi for details -->
								<option value="1" select="True">1. Standard</option>
								<option value="2">2. Vertebrate Mitochondrial</option>
								<option value="3">3. Yeast Mitochondrial</option>
								<option value="4">4. Mold, Protozoan, and Coelenterate Mitochondrial Code and the Mycoplasma/Spiroplasma Code</option>
								<option value="5">5. Invertebrate Mitochondrial</option>
								<option value="6">6. Ciliate, Dasycladacean and Hexamita Nuclear Code</option>
								<option value="9">9. Echinoderm Mitochondrial</option>
								<option value="10">10. Euplotid Nuclear</option>
								<option value="11">11. Bacteria and Archaea</option>
								<option value="12">12. Alternative Yeast Nuclear</option>
								<option value="13">13. Ascidian Mitochondrial</option>
								<option value="14">14. Flatworm Mitochondrial</option>
								<option value="15">15. Blepharisma Macronuclear</option>
								<option value="16">16. Chlorophycean Mitochondrial Code</option>
								<option value="21">21. Trematode Mitochondrial Code</option>
								<option value="22">22. Scenedesmus obliquus mitochondrial Code</option>
								<option value="23">23. Thraustochytrium Mitochondrial Code</option>
								<option value="24">24. Pterobranchia mitochondrial code</option>
							</param>						
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-seg yes" falsevalue="-seg no" checked="true" />
							<param name="strand" type="select" label="Query strand(s) to search against database/subject">
								<option value="-strand both">Both</option>
								<option value="-strand plus">Plus (forward)</option>
								<option value="-strand minus">Minus (reverse complement)</option>
							</param>
							<param name="matrix" type="select" label="Scoring matrix">
								<!-- [NON DISPONIBLE] <option value="BLOSUM90">BLOSUM90</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM80">BLOSUM80</option> -->
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM45">BLOSUM45</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM250">PAM250</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM70">PAM70</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM30">PAM30</option> -->
							</param>
							<param name="max_hits" type="integer" value="0" label="Maximum hits to show" help="Use zero for default limits">
								<validator type="in_range" min="0" />
							</param>
							<param name="word_size" type="integer" value="0" label="Word size for wordfinder algorithm" help="Use zero for default, otherwise minimum 2.">
								<validator type="in_range" min="0" />
							</param>
							<param name="parse_deflines" type="boolean" label="Should the query and subject defline(s) be parsed?" truevalue="-parse_deflines" falsevalue="" checked="false" help="This affects the formatting of the query/subject ID strings"/>
							<conditional name="adv_optional_id_files_opts">
								<param name="adv_optional_id_files_opts_selector" type="select" label="Restrict search of database to a given set of ID's" help="This feature provides a means to exclude ID's from a BLAST database search. The expectation values in the BLAST results are based upon the sequences actually searched, and not on the underlying database. Note this cannot be used when comparing against a FASTA file.">
									<option value="none" selected="True">No restriction, search the entire database</option>
									<option value="gilist">GI identifiers</option>
									<option value="negative_gilist">Negative GI identifiers</option>
									<option value="seqidlist">Sequence identifiers (SeqId's)</option>
								</param>
								<when value="none" />
								<when value="gilist">
									<param name="gilist" type="data" format="txt" label="Restrict search of database to GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="negative_gilist">
									<param name="negative_gilist" type="data" format="txt" label="Restrict search of database to everything except the GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="seqidlist">
									<param name="seqidlist" type="data" format="txt" label=" Restrict search of database to list of SeqId's" help="This option is only available for database searches."/>
								</when>
							</conditional>
							<param name="qcov_hsp_perc" type="float" value="0" min="0" max="100" label="Minimum query coverage per hsp (percentage, 0 to 100)" help="See also the output column qhspcov"/>


				

						</when>
					</conditional>





				</when>
				<when value="blastx">
					<param name="query" type="data" format="fasta" label="Nucleotide query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Protein BLAST database">
								<options from_data_table="blastdb_p" />
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbp" label="Protein BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Protein FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="query_gencode" type="select" label="Query genetic code">
					<!-- See http://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi for details -->
						<option value="1" select="True">1. Standard</option>
						<option value="2">2. Vertebrate Mitochondrial</option>
						<option value="3">3. Yeast Mitochondrial</option>
						<option value="4">4. Mold, Protozoan, and Coelenterate Mitochondrial Code and the Mycoplasma/Spiroplasma Code</option>
						<option value="5">5. Invertebrate Mitochondrial</option>
						<option value="6">6. Ciliate, Dasycladacean and Hexamita Nuclear Code</option>
						<option value="9">9. Echinoderm Mitochondrial</option>
						<option value="10">10. Euplotid Nuclear</option>
						<option value="11">11. Bacteria and Archaea</option>
						<option value="12">12. Alternative Yeast Nuclear</option>
						<option value="13">13. Ascidian Mitochondrial</option>
						<option value="14">14. Flatworm Mitochondrial</option>
						<option value="15">15. Blepharisma Macronuclear</option>
						<option value="16">16. Chlorophycean Mitochondrial Code</option>
						<option value="21">21. Trematode Mitochondrial Code</option>
						<option value="22">22. Scenedesmus obliquus mitochondrial Code</option>
						<option value="23">23. Thraustochytrium Mitochondrial Code</option>
						<option value="24">24. Pterobranchia mitochondrial code</option>
					</param>
					<param name="blast_type" type="select" display="radio" label="Type of BLAST">
						<option value="blastx">blastx - Traditional BLASTX to compare translated nucleotide query to protein database</option>
						<option value="blastx-fast">blastx-fast - Use longer words for seeding, faster but less accurate</option>
					</param>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="Set expectation value cutoff" />
					<conditional name="output">
						<param name="out_format" type="select" label="Output format">
							<!-- [NON DISPONIBLE] <option value="6">Tabular (standard 12 columns)</option> -->
							<option value="ext" selected="True">Tabular (extended 25 columns)</option>
							<!-- [NON DISPONIBLE] <option value="cols">Tabular (select which columns)</option> -->
							<!-- [NON DISPONIBLE] <option value="5">BLAST XML</option> -->
							<!-- [NON DISPONIBLE] <option value="0">Pairwise text</option> -->
							<!-- [NON DISPONIBLE] <option value="0 -html">Pairwise HTML</option> -->
                			<!-- [NON DISPONIBLE] 		<option value="2">Query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="2 -html">Query-anchored HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="4">Flat query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="4 -html">Flat query-anchored HTML</option> -->
						</param>
						<when value="6"/>
						<when value="ext"/>
						<when value="cols">
							<param name="std_cols" type="select" multiple="true" display="checkboxes" label="Standard columns">
								<option selected="true" value="qseqid">qseqid = Query Seq-id (ID of your sequence)</option>
								<option selected="true" value="sseqid">sseqid = Subject Seq-id (ID of the database hit)</option>
								<option selected="true" value="pident">pident = Percentage of identical matches</option>
								<option selected="true" value="length">length = Alignment length</option>
								<option selected="true" value="mismatch">mismatch = Number of mismatches</option>
								<option selected="true" value="gapopen">gapopen = Number of gap openings</option>
								<option selected="true" value="qstart">qstart = Start of alignment in query</option>
								<option selected="true" value="qend">qend = End of alignment in query</option>
								<option selected="true" value="sstart">sstart = Start of alignment in subject (database hit)</option>
								<option selected="true" value="send">send = End of alignment in subject (database hit)</option>
								<option selected="true" value="evalue">evalue = Expectation value (E-value)</option>
								<option selected="true" value="bitscore">bitscore = Bit score</option>
							</param>
							<param name="ext_cols" type="select" multiple="true" display="checkboxes" label="Extended columns">
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="score">score = Raw score</option>
								<option value="nident">nident = Number of identical matches</option>
								<option value="positive">positive = Number of positive-scoring matches</option>
								<option value="gaps">gaps = Total number of gaps</option>
								<option value="ppos">ppos = Percentage of positive-scoring matches</option>
								<option value="qframe">qframe = Query frame</option>
								<option value="sframe">sframe = Subject frame</option>
								<option value="qseq">qseq = Aligned part of query sequence</option>
								<option value="sseq">sseq = Aligned part of subject sequence</option>
								<option value="qlen">qlen = Query sequence length</option>
								<option value="slen">slen = Subject sequence length</option>
								<option value="salltitles">salltitles = All subject title(s), separated by a '&lt;&gt;'</option>
							</param>
							<param name="ids_cols" type="select" multiple="true" display="checkboxes" label="Other identifier columns">
								<option value="qgi">qgi = Query GI</option>
								<option value="qacc">qacc = Query accesion</option>
								<option value="qaccver">qaccver = Query accesion.version</option>
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="sgi">sgi = Subject GI</option>
								<option value="sallgi">sallgi = All subject GIs</option>
								<option value="sacc">sacc = Subject accession</option>
								<option value="saccver">saccver = Subject accession.version</option>
								<option value="sallacc">sallacc = All subject accessions</option>
								<option value="stitle">stitle = Subject Title</option>
							</param>
							<param name="misc_cols" type="select" multiple="true" display="checkboxes" label="Miscellaneous columns">
								<option value="sstrand">sstrand = Subject Strand</option>
								<option value="frames">frames = Query and subject frames separated by a '/'</option>
								<option value="btop">btop = Blast traceback operations (BTOP)</option>
								<option value="qcovs">qcovs = Query Coverage Per Subject</option>
								<option value="qcovhsp">qcovhsp = Query Coverage Per HSP</option>
							</param>
							<param name="tax_cols" type="select" multiple="true" display="checkboxes" label="Taxonomy columns">
                    						<option value="staxids">staxids = unique Subject Taxonomy ID(s), separated by a ';' (in numerical order)</option>
								<option value="sscinames">sscinames = unique Subject Scientific Name(s), separated by a ';'</option>
								<option value="scomnames">scomnames = unique Subject Common Name(s), separated by a ';'</option>
								<option value="sblastnames">sblastnames = unique Subject Blast Name(s), separated by a ';' (in alphabetical order)</option>
								<option value="sskingdoms">sskingdoms = unique Subject Super Kingdom(s), separated by a ';' (in alphabetical order)</option>
							</param>
						</when>
						<when value="5"/>
						<when value="0"/>
						<when value="0 -html"/>
						<when value="2"/>
						<when value="2 -html"/>
						<when value="4"/>
						<when value="4 -html"/>
					</conditional>
					<conditional name="adv_opts">
						<param name="adv_opts_selector" type="select" label="Advanced Options">
							<option value="basic" selected="True">Hide Advanced Options</option>
							<option value="advanced">Show Advanced Options</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-seg yes" falsevalue="-seg no" checked="true" />
							<param name="strand" type="select" label="Query strand(s) to search against database/subject">
								<option value="-strand both">Both</option>
								<option value="-strand plus">Plus (forward)</option>
								<option value="-strand minus">Minus (reverse complement)</option>
							</param>
							<param name="matrix" type="select" label="Scoring matrix">
								<!-- [NON DISPONIBLE]  <option value="BLOSUM90">BLOSUM90</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM80">BLOSUM80</option> -->
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM45">BLOSUM45</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM250">PAM250</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM70">PAM70</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM30">PAM30</option> -->
							</param>
							<param name="max_hits" type="integer" value="0" label="Maximum hits to show" help="Use zero for default limits">
								<validator type="in_range" min="0" />
							</param>
							<param name="word_size" type="integer" value="0" label="Word size for wordfinder algorithm" help="Use zero for default, otherwise minimum 2.">
								<validator type="in_range" min="0" />
							</param>
							<param name="ungapped" type="boolean" label="Perform ungapped alignment only?" truevalue="-ungapped" falsevalue="" checked="false" />
							<param name="parse_deflines" type="boolean" label="Should the query and subject defline(s) be parsed?" truevalue="-parse_deflines" falsevalue="" checked="false" help="This affects the formatting of the query/subject ID strings"/>
							<conditional name="adv_optional_id_files_opts">
								<param name="adv_optional_id_files_opts_selector" type="select" label="Restrict search of database to a given set of ID's" help="This feature provides a means to exclude ID's from a BLAST database search. The expectation values in the BLAST results are based upon the sequences actually searched, and not on the underlying database. Note this cannot be used when comparing against a FASTA file.">
									<option value="none" selected="True">No restriction, search the entire database</option>
                							<option value="gilist">GI identifiers</option>
									<option value="negative_gilist">Negative GI identifiers</option>
									<option value="seqidlist">Sequence identifiers (SeqId's)</option>
								</param>
								<when value="none" />
								<when value="gilist">
									<param name="gilist" type="data" format="txt" label="Restrict search of database to GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="negative_gilist">
									<param name="negative_gilist" type="data" format="txt" label="Restrict search of database to everything except the GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="seqidlist">
									<param name="seqidlist" type="data" format="txt" label=" Restrict search of database to list of SeqId's" help="This option is only available for database searches."/>
								</when>
							</conditional>
							<param name="qcov_hsp_perc" type="float" value="0" min="0" max="100" label="Minimum query coverage per hsp (percentage, 0 to 100)" help="See also the output column qhspcov"/>

						</when>
					</conditional>	
				</when>
				<when value="tblastn">
					<param name="query" type="data" format="fasta" label="Protein query sequence(s)"/>
					<conditional name="db_opts">
						<param name="db_opts_selector" type="select" label="Subject database/sequences">
							<option value="db" selected="True">Locally installed BLAST database</option>
							<option value="histdb">BLAST database from your history</option>
							<option value="file">FASTA file from your history (see warning note below)</option>
						</param>
						<when value="db">
							<param name="database" type="select" label="Nucleotide BLAST database">
								<options from_data_table="blastdb" />
							</param>
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="histdb">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="data" format="blastdbn" label="Nucleotide BLAST database" />
							<param name="subject" type="hidden" value="" />
						</when>
						<when value="file">
							<param name="database" type="hidden" value="" />
							<param name="histdb" type="hidden" value="" />
							<param name="subject" type="data" format="fasta" label="Nucleotide FASTA file to use as database"/>
						</when>
					</conditional>
					<param name="blast_type" type="select" display="radio" label="Type of BLAST">
						<option value="tblastn">tblastn - Traditional TBLASTN to compare protein query to translated nucleotide database</option>
						<option value="tblastn-fast">tblastn-fast - Use longer words for seeding, faster but less accurate</option>
					</param>
					<param name="evalue_cutoff" type="float" size="15" value="0.001" label="Set expectation value cutoff" />
					<conditional name="output">
						<param name="out_format" type="select" label="Output format">
							<!-- [NON DISPONIBLE] <option value="6">Tabular (standard 12 columns)</option> -->
							<option value="ext" selected="True">Tabular (extended 25 columns)</option>
							<!-- [NON DISPONIBLE] <option value="cols">Tabular (select which columns)</option> -->
							<!-- [NON DISPONIBLE] <option value="5">BLAST XML</option> -->
							<!-- [NON DISPONIBLE] <option value="0">Pairwise text</option> -->
							<!-- [NON DISPONIBLE] <option value="0 -html">Pairwise HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="2">Query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="2 -html">Query-anchored HTML</option> -->
							<!-- [NON DISPONIBLE] <option value="4">Flat query-anchored text</option> -->
							<!-- [NON DISPONIBLE] <option value="4 -html">Flat query-anchored HTML</option> -->
						</param>
						<when value="6"/>
						<when value="ext"/>
						<when value="cols">
							<param name="std_cols" type="select" multiple="true" display="checkboxes" label="Standard columns">
								<option selected="true" value="qseqid">qseqid = Query Seq-id (ID of your sequence)</option>
								<option selected="true" value="sseqid">sseqid = Subject Seq-id (ID of the database hit)</option>
								<option selected="true" value="pident">pident = Percentage of identical matches</option>
								<option selected="true" value="length">length = Alignment length</option>
								<option selected="true" value="mismatch">mismatch = Number of mismatches</option>
								<option selected="true" value="gapopen">gapopen = Number of gap openings</option>
								<option selected="true" value="qstart">qstart = Start of alignment in query</option>
								<option selected="true" value="qend">qend = End of alignment in query</option>
								<option selected="true" value="sstart">sstart = Start of alignment in subject (database hit)</option>
								<option selected="true" value="send">send = End of alignment in subject (database hit)</option>
								<option selected="true" value="evalue">evalue = Expectation value (E-value)</option>
								<option selected="true" value="bitscore">bitscore = Bit score</option>
							</param>
						 	<param name="ext_cols" type="select" multiple="true" display="checkboxes" label="Extended columns">
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="score">score = Raw score</option>
								<option value="nident">nident = Number of identical matches</option>
								<option value="positive">positive = Number of positive-scoring matches</option>
								<option value="gaps">gaps = Total number of gaps</option>
								<option value="ppos">ppos = Percentage of positive-scoring matches</option>
								<option value="qframe">qframe = Query frame</option>
								<option value="sframe">sframe = Subject frame</option>
								<option value="qseq">qseq = Aligned part of query sequence</option>
								<option value="sseq">sseq = Aligned part of subject sequence</option>
								<option value="qlen">qlen = Query sequence length</option>
								<option value="slen">slen = Subject sequence length</option>
								<option value="salltitles">salltitles = All subject title(s), separated by a '&lt;&gt;'</option>
							</param>
							<param name="ids_cols" type="select" multiple="true" display="checkboxes" label="Other identifier columns">
								<option value="qgi">qgi = Query GI</option>
								<option value="qacc">qacc = Query accesion</option>
								<option value="qaccver">qaccver = Query accesion.version</option>
								<option value="sallseqid">sallseqid = All subject Seq-id(s), separated by a ';'</option>
								<option value="sgi">sgi = Subject GI</option>
								<option value="sallgi">sallgi = All subject GIs</option>
								<option value="sacc">sacc = Subject accession</option>
								<option value="saccver">saccver = Subject accession.version</option>
								<option value="sallacc">sallacc = All subject accessions</option>
								<option value="stitle">stitle = Subject Title</option>
							</param>
							<param name="misc_cols" type="select" multiple="true" display="checkboxes" label="Miscellaneous columns">
								<option value="sstrand">sstrand = Subject Strand</option>
								<option value="frames">frames = Query and subject frames separated by a '/'</option>
								<option value="btop">btop = Blast traceback operations (BTOP)</option>
								<option value="qcovs">qcovs = Query Coverage Per Subject</option>
								<option value="qcovhsp">qcovhsp = Query Coverage Per HSP</option>
							</param>
							<param name="tax_cols" type="select" multiple="true" display="checkboxes" label="Taxonomy columns">
								<option value="staxids">staxids = unique Subject Taxonomy ID(s), separated by a ';' (in numerical order)</option>
                    						<option value="sscinames">sscinames = unique Subject Scientific Name(s), separated by a ';'</option>
								<option value="scomnames">scomnames = unique Subject Common Name(s), separated by a ';'</option>
								<option value="sblastnames">sblastnames = unique Subject Blast Name(s), separated by a ';' (in alphabetical order)</option>
								<option value="sskingdoms">sskingdoms = unique Subject Super Kingdom(s), separated by a ';' (in alphabetical order)</option>
							</param>
						</when>
						<when value="5"/>
						<when value="0"/>
						<when value="0 -html"/>
						<when value="2"/>
						<when value="2 -html"/>
						<when value="4"/>
						<when value="4 -html"/>
					</conditional>
					<conditional name="adv_opts">
						<param name="adv_opts_selector" type="select" label="Advanced Options">
							<option value="basic" selected="True">Hide Advanced Options</option>
							<option value="advanced">Show Advanced Options</option>
						</param>
						<when value="basic" />
						<when value="advanced">
							 <param name="db_gencode" type="select" label="Database/subject genetic code">
								<option value="1" select="True">1. Standard</option>
								<option value="2">2. Vertebrate Mitochondrial</option>
								<option value="3">3. Yeast Mitochondrial</option>
								<option value="4">4. Mold, Protozoan, and Coelenterate Mitochondrial Code and the Mycoplasma/Spiroplasma Code</option>
								<option value="5">5. Invertebrate Mitochondrial</option>
								<option value="6">6. Ciliate, Dasycladacean and Hexamita Nuclear Code</option>
								<option value="9">9. Echinoderm Mitochondrial</option>
								<option value="10">10. Euplotid Nuclear</option>
								<option value="11">11. Bacteria and Archaea</option>
								<option value="12">12. Alternative Yeast Nuclear</option>
								<option value="13">13. Ascidian Mitochondrial</option>
								<option value="14">14. Flatworm Mitochondrial</option>
								<option value="15">15. Blepharisma Macronuclear</option>
								<option value="16">16. Chlorophycean Mitochondrial Code</option>
								<option value="21">21. Trematode Mitochondrial Code</option>
								<option value="22">22. Scenedesmus obliquus mitochondrial Code</option>
								<option value="23">23. Thraustochytrium Mitochondrial Code</option>
								<option value="24">24. Pterobranchia mitochondrial code</option>
							</param>
							<param name="filter_query" type="boolean" label="Filter out low complexity regions (with SEG)" truevalue="-seg yes" falsevalue="-seg no" checked="true" />
							<param name="matrix" type="select" label="Scoring matrix">
								<!-- [NON DISPONIBLE] <option value="BLOSUM90">BLOSUM90</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM80">BLOSUM80</option> -->
								<option value="BLOSUM62" selected="true">BLOSUM62 (default)</option>
								<!-- [NON DISPONIBLE] <option value="BLOSUM50">BLOSUM50</option> -->
								<!-- [NON DISPONIBLE] <option value="BLOSUM45">BLOSUM45</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM250">PAM250</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM70">PAM70</option> -->
								<!-- [NON DISPONIBLE] <option value="PAM30">PAM30</option> -->
							</param>
							<param name="max_hits" type="integer" value="0" label="Maximum hits to show" help="Use zero for default limits">
								<validator type="in_range" min="0" />
							</param>
							<param name="word_size" type="integer" value="0" label="Word size for wordfinder algorithm" help="Use zero for default, otherwise minimum 2.">
								<validator type="in_range" min="0" />
							</param>
							<param name="parse_deflines" type="boolean" label="Should the query and subject defline(s) be parsed?" truevalue="-parse_deflines" falsevalue="" checked="false" help="This affects the formatting of the query/subject ID strings"/>
							<conditional name="adv_optional_id_files_opts">
								<param name="adv_optional_id_files_opts_selector" type="select" label="Restrict search of database to a given set of ID's" help="This feature provides a means to exclude ID's from a BLAST database search. The expectation values in the BLAST results are based upon the sequences actually searched, and not on the underlying database. Note this cannot be used when comparing against a FASTA file.">
									<option value="none" selected="True">No restriction, search the entire database</option>
									<option value="gilist">GI identifiers</option>
									<option value="negative_gilist">Negative GI identifiers</option>
									<option value="seqidlist">Sequence identifiers (SeqId's)</option>
								</param>
								<when value="none" />
								<when value="gilist">
									<param name="gilist" type="data" format="txt" label="Restrict search of database to GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="negative_gilist">
									<param name="negative_gilist" type="data" format="txt" label="Restrict search of database to everything except the GI's listed in this file" help="This option is only available for database searches."/>
								</when>
								<when value="seqidlist">
									<param name="seqidlist" type="data" format="txt" label=" Restrict search of database to list of SeqId's" help="This option is only available for database searches."/>
								</when>
							</conditional>
							<param name="qcov_hsp_perc" type="float" value="0" min="0" max="100" label="Minimum query coverage per hsp (percentage, 0 to 100)" help="See also the output column qhspcov"/>
						</when>
					</conditional>
				</when>
			</conditional>
		</when>
	</conditional>
	
	</inputs>




	<outputs>
		<data format="html" name="html_file" label="ngklast"/>
	</outputs>

	<help>
	Run ngklast.
  	</help>
</tool>
